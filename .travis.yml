---
language: python
python: "2.7"

addons:
  hosts:
    - zendevbox.com

before_install:
  # create ubuntu user
  - sudo useradd ubuntu
  - sudo usermod -a -G sudo ubuntu
  - sudo service postgresql stop

install:
  # Install pip dependencies.
  - pip install -r deployment/deploy-requirements.txt

script:
  # Check the role/playbook's syntax.
  - ansible-playbook -i deployment/ansible/inventory-example-static/dev deployment/ansible/playbook/site_static.yml -vvvv --syntax-check
  - ansible-playbook -i deployment/ansible/inventory-example-django/dev deployment/ansible/playbook/site_django.yml -vvvv --syntax-check

  # Run the role/playbook.
  - ansible-playbook -i deployment/ansible/inventory-example-static/dev deployment/ansible/playbook/site_static.yml -vvvv --connection=local --sudo
  - ansible-playbook -i deployment/ansible/inventory-example-django/dev deployment/ansible/playbook/site_django.yml -vvvv --connection=local --sudo
